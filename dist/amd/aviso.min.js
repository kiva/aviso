/**
 * aviso.js - v0.1.3 
 * Copyright (c) 2013 Kiva Microfunds
 * 
 * Licensed under the MIT license.
 * https://github.com/kiva/backbone.siren/blob/master/license.txt
 */
define(["jquery"],function(s){"use strict";function e(e,n){var o,a;return"object"!=typeof e||e instanceof jQuery||s.isArray(e)||e.message?"string"==typeof n&&(n={type:n}):n=e,o=i(n),a=new t(o),e&&a.show(e,o),a}function t(e){if(this.$el=s(e.el),this.$close=s("."+e.closeClass,this.$el).on("click.aviso",s.proxy(n,this)),this.$content=s("."+e.contentClass,this.$el),!this.$el||!this.$close||!this.$content)throw"Aviso Error: Missing required markup";s("body").append(this.$el)}function i(t){return s.extend({},e.defaults,t)}function n(s){s.preventDefault(),this.close()}return e._messages={},e.defaults={validTypes:["info","warning","error"],el:'<div class="avisoWrapper"><div class="avisoContainer"><div class="avisoClose">x</div><div class="avisoContent"></div></div></div>',elClass:"avisoWrapper",closeClass:"avisoClose",contentClass:"avisoContent",containerClass:"avisoContainer",scrollOnShow:!1},t.prototype={slideDown:function(){return this.$el.css("opacity",1).slideDown().promise()},slideUp:function(){return this.$el.css("opacity",.3).slideUp().promise()},renderMessage:function(e,t){var i;return i=0>s.inArray(t.type,t.validTypes)?t.validTypes[0]:t.type,this.setMessageType(i,t),'<div class="avisoMsg avisoMsg-'+i+'">'+e+"</div>"},setMessageType:function(e,t){var i=t.validTypes;(!this.messageType||s.inArray(e,i)>s.inArray(this.messageType,i))&&(this.messageType=e)},add:function(e,t){var i;return"object"==typeof e?(i=s.extend({},t,e.options),e=e.message):i=t,this.renderMessage(e,i)},_show:function(t,i){var n,o=this;t instanceof jQuery?n=t:s.isArray(t)?(n=s("<div />"),s.each(t,function(s,e){n.append(o.add(e,i))}),n=n.html()):("string"==typeof t||"object"==typeof t)&&(n=s(this.add(t,i))),this.$el.addClass(i.elClass+"-"+this.messageType),this.$content.append(n),e._messages["default"]=this,i.scrollOnShow&&s("html, body").animate({scrollTop:0}),this.slideDown()},show:function(s,t){var i=this,n=e._messages["default"];n?n.close().done(function(){i._show(s,t)}):this._show(s,t)},close:function(){var s=this;return this.slideUp().done(function(){s.$el.remove(),e._messages["default"]=null})}},e});