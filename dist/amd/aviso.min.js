/**
 * aviso.js - v0.1.1 
 * Copyright (c) 2013 Kiva Microfunds
 * 
 * Licensed under the MIT license.
 * https://github.com/kiva/backbone.siren/blob/master/license.txt
 */
define(["jquery"],function(s){"use strict";function e(e,o){var n,a;return"object"!=typeof e||e instanceof jQuery||s.isArray(e)||e.message?"string"==typeof o&&(o={type:o}):o=e,n=i(o),a=new t(n),e&&a.show(e,n),a}function t(e){if(this.$el=s(e.el),this.$close=s(e.closeClass,this.$el).on("click.aviso",s.proxy(n,this)),this.$content=s(e.contentClass,this.$el),!this.$el||!this.$close||!this.$content)throw"Aviso Error: Missing required markup";s("body").append(this.$el)}function i(t){return s.extend({},e.defaults,t)}function o(s){return'<div class="avisoMsg">'+s+"</div>"}function n(s){s.preventDefault(),this.close()}return e._messages={},e.defaults={validTypes:["info","warning","error"],el:'<div class="avisoWrapper"><div class="avisoContainer"><div class="avisoClose">x</div><div class="avisoContent"></div></div></div>',elClass:".avisoWrapper",closeClass:".avisoClose",contentClass:".avisoContent",containerClass:".avisoContainer"},t.prototype={slideDown:function(){return this.$el.css("opacity",1).slideDown().promise()},slideUp:function(){return this.$el.css("opacity",.3).slideUp("slow").promise()},add:function(e,t){var i;return"object"==typeof e?(i=s.extend({},t,e.options),e=e.message):i=t,o(e,i)},_show:function(t,i){var o,n=this;t instanceof jQuery?o=t:s.isArray(t)?(o=s("<div />"),s.each(t,function(s,e){o.append(n.add(e,i))}),o=o.html()):("string"==typeof t||"object"==typeof t)&&(o=s(this.add(t,i))),this.$content.append(o),e._messages.one=this,s("html, body").animate({scrollTop:0}),this.slideDown()},show:function(s,t){var i=this,o=e._messages.one;o?o.close().done(function(){i._show(s,t)}):this._show(s,t)},close:function(){var s=this;return this.slideUp().done(function(){s.$el.remove(),e._messages.one=null})}},e});