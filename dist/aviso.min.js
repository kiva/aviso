/**
 * aviso.js - v0.1.2 
 * Copyright (c) 2013 Kiva Microfunds
 * 
 * Licensed under the MIT license.
 * https://github.com/kiva/backbone.siren/blob/master/license.txt
 */
(function(s,e){"use strict";function t(e,t){var o,a;return"object"!=typeof e||e instanceof jQuery||s.isArray(e)||e.message?"string"==typeof t&&(t={type:t}):t=e,o=n(t),a=new i(o),e&&a.show(e,o),a}function i(e){if(this.$el=s(e.el),this.$close=s("."+e.closeClass,this.$el).on("click.aviso",s.proxy(o,this)),this.$content=s("."+e.contentClass,this.$el),!this.$el||!this.$close||!this.$content)throw"Aviso Error: Missing required markup";s("body").append(this.$el)}function n(e){return s.extend({},t.defaults,e)}function o(s){s.preventDefault(),this.close()}t._messages={},t.defaults={validTypes:["info","warning","error"],el:'<div class="avisoWrapper"><div class="avisoContainer"><div class="avisoClose">x</div><div class="avisoContent"></div></div></div>',elClass:"avisoWrapper",closeClass:"avisoClose",contentClass:"avisoContent",containerClass:"avisoContainer"},i.prototype={slideDown:function(){return this.$el.css("opacity",1).slideDown().promise()},slideUp:function(){return this.$el.css("opacity",.3).slideUp("slow").promise()},renderMessage:function(e,t){var i;return i=0>s.inArray(t.type,t.validTypes)?t.validTypes[0]:t.type,this.setMessageType(i,t),'<div class="avisoMsg avisoMsg-'+i+'">'+e+"</div>"},setMessageType:function(e,t){var i=t.validTypes;(!this.messageType||s.inArray(e,i)>s.inArray(this.messageType,i))&&(this.messageType=e)},add:function(e,t){var i;return"object"==typeof e?(i=s.extend({},t,e.options),e=e.message):i=t,this.renderMessage(e,i)},_show:function(e,i){var n,o=this;e instanceof jQuery?n=e:s.isArray(e)?(n=s("<div />"),s.each(e,function(s,e){n.append(o.add(e,i))}),n=n.html()):("string"==typeof e||"object"==typeof e)&&(n=s(this.add(e,i))),this.$el.addClass(i.elClass+"-"+this.messageType),this.$content.append(n),t._messages["default"]=this,s("html, body").animate({scrollTop:0}),this.slideDown()},show:function(s,e){var i=this,n=t._messages["default"];n?n.close().done(function(){i._show(s,e)}):this._show(s,e)},close:function(){var s=this;return this.slideUp().done(function(){s.$el.remove(),t._messages["default"]=null})}},e.aviso=t})(jQuery,this);